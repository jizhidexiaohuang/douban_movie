!function(o){o.module("movieApp",["movie_home","movie_details","movie_list","ask"]).controller("movieCtrl",["$scope","$window",function(o,e){o.search=function(){e.location.hash="/search?q="+o.val}}])}(angular),function(o){var e=o.module("movie_details",["ngRoute","ask"]);e.config(["$routeProvider",function(o){o.when("/details/:id",{templateUrl:"view/details.html",controller:"detailsCtrl"})}]),e.controller("detailsCtrl",["$scope","$routeParams","askJson",function(o,e,t){var a=e.id;o.isShow=!0,t.jsonp({url:"http://api.douban.com/v2/movie/subject/"+a,callback:function(e){o.isShow=!1,o.movie=e,o.$apply()}})}])}(angular),function(o){var e=o.module("movie_home",["ngRoute"]);e.config(["$locationProvider",function(o){o.hashPrefix("")}]),e.config(["$routeProvider",function(o){o.when("/home",{templateUrl:"./view/home.html"}).when("/",{redirectTo:"/home"})}])}(angular),function(o){var e=o.module("movie_list",["ngRoute","ask"]);e.config(["$routeProvider",function(o){o.when("/:type/:page?",{templateUrl:"./view/movie_list.html",controller:"movie_listCtrl"})}]),e.controller("movie_listCtrl",["$scope","$route","$window","$routeParams","askJson",function(o,e,t,a,n){o.isShow=!0,o.pageStart=a.page-0||1,o.pageCount=10,n.jsonp({url:"http://api.douban.com/v2/movie/"+a.type,params:{start:(o.pageStart-1)*o.pageCount,count:o.pageCount,q:a.q},callback:function(e){o.isShow=!1,o.movies=e,o.pageTotal=t.Math.ceil(e.total/o.pageCount),o.$apply()}}),o.getPage=function(t){t<1||t>o.pageTotal||e.updateParams({page:t})}}])}(angular),function(o){var e=o.module("ask",[]);e.service("askJson",["$window",function(o){this.jsonp=function(e){var t=e.url+"?";for(var a in e.params)t+=a+"="+e.params[a]+"&";var n="jsonp_"+o.Math.random().toString().slice(2);o[n]=e.callback,t+="callback="+n;var i=o.document.createElement("script");i.src=t,o.document.body.appendChild(i)}}]),e.directive("askActive",function(){return{restrict:"A",link:function(o,e,t){e.on("click",function(){e.parent().children().removeClass("active"),e.addClass("active")})}}})}(angular);